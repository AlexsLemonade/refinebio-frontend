const initialState = {
  experiments: [
    {
      id: 1,
      title:
        'Integrated bioinformatic and wet-lab approach to identify potential oncogenic networks in neuroblastoma and other tumors',
      description:
        'This SuperSeries is composed of the SubSeries listed below. Refer to individual Series',
      accession_code: 'E-GEOD-16254',
      platform_accession_code: 'A-AFFY-44',
      source_database: 'ARRAY_EXPRESS',
      source_url:
        'https://www.ebi.ac.uk/arrayexpress/json/v3/experiments/E-GEOD-16254',
      platform_name:
        'Affymetrix GeneChip Human Genome U133 Plus 2.0 [HG-U133_Plus_2]',
      has_publication: false,
      publication_title: '',
      publication_doi: '',
      pubmed_id: '',
      samples: [
        {
          id: 1,
          accession_code: 'GSM414087 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.889263Z',
          last_modified: '2018-04-19T18:46:50.889263Z'
        },
        {
          id: 2,
          accession_code: 'GSM414086 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.921606Z',
          last_modified: '2018-04-19T18:46:50.921606Z'
        },
        {
          id: 3,
          accession_code: 'GSM414085 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.934763Z',
          last_modified: '2018-04-19T18:46:50.934763Z'
        },
        {
          id: 4,
          accession_code: 'GSM414084 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.949774Z',
          last_modified: '2018-04-19T18:46:50.949774Z'
        },
        {
          id: 5,
          accession_code: 'GSM414083 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.965318Z',
          last_modified: '2018-04-19T18:46:50.965318Z'
        },
        {
          id: 6,
          accession_code: 'GSM414082 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.980007Z',
          last_modified: '2018-04-19T18:46:50.980007Z'
        },
        {
          id: 7,
          accession_code: 'GSM414081 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.996349Z',
          last_modified: '2018-04-19T18:46:50.996349Z'
        },
        {
          id: 8,
          accession_code: 'GSM414080 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.008842Z',
          last_modified: '2018-04-19T18:46:51.008842Z'
        },
        {
          id: 9,
          accession_code: 'GSM414079 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.019163Z',
          last_modified: '2018-04-19T18:46:51.019163Z'
        },
        {
          id: 10,
          accession_code: 'GSM414078 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.030051Z',
          last_modified: '2018-04-19T18:46:51.030051Z'
        },
        {
          id: 11,
          accession_code: 'GSM414077 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.039925Z',
          last_modified: '2018-04-19T18:46:51.039925Z'
        },
        {
          id: 12,
          accession_code: 'GSM414076 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.050403Z',
          last_modified: '2018-04-19T18:46:51.050403Z'
        },
        {
          id: 13,
          accession_code: 'GSM414075 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.059208Z',
          last_modified: '2018-04-19T18:46:51.059208Z'
        },
        {
          id: 14,
          accession_code: 'GSM414074 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.068174Z',
          last_modified: '2018-04-19T18:46:51.068174Z'
        },
        {
          id: 15,
          accession_code: 'GSM414073 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.077299Z',
          last_modified: '2018-04-19T18:46:51.077299Z'
        },
        {
          id: 16,
          accession_code: 'GSM414072 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.085685Z',
          last_modified: '2018-04-19T18:46:51.085685Z'
        },
        {
          id: 17,
          accession_code: 'GSM414071 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.094268Z',
          last_modified: '2018-04-19T18:46:51.094268Z'
        },
        {
          id: 18,
          accession_code: 'GSM414070 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.102816Z',
          last_modified: '2018-04-19T18:46:51.102816Z'
        },
        {
          id: 19,
          accession_code: 'GSM414069 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.111942Z',
          last_modified: '2018-04-19T18:46:51.111942Z'
        },
        {
          id: 20,
          accession_code: 'GSM414068 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.123123Z',
          last_modified: '2018-04-19T18:46:51.123123Z'
        },
        {
          id: 21,
          accession_code: 'GSM414067 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.131672Z',
          last_modified: '2018-04-19T18:46:51.131672Z'
        },
        {
          id: 22,
          accession_code: 'GSM414066 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.140599Z',
          last_modified: '2018-04-19T18:46:51.140599Z'
        },
        {
          id: 23,
          accession_code: 'GSM414065 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.149730Z',
          last_modified: '2018-04-19T18:46:51.149730Z'
        },
        {
          id: 24,
          accession_code: 'GSM414064 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.159144Z',
          last_modified: '2018-04-19T18:46:51.159144Z'
        },
        {
          id: 25,
          accession_code: 'GSM414063 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.169261Z',
          last_modified: '2018-04-19T18:46:51.169261Z'
        }
      ],
      submitter_institution: 'Academic Medical Centre, University of Amsterdam',
      created_at: '2018-04-19T18:46:47.666345Z',
      last_modified: '2018-04-19T18:46:48.309913Z'
    },
    {
      id: 2,
      title:
        'Transcription profiling of human neuroblast tumours reveals two distinct gene signatures identify malignant Neuroblast and Schwannian stromal cells',
      description:
        'Tumor tissue heterogeneity is a well known feature of several solid tumors. Neuroblastic Tumors (NTs) is a group of paediatric cancers with a great tissue heterogeneity. Most of NTs are composed of undifferentiated, poorly differentiated or differentiating neuroblastic (Nb) cells with very few or absent Schwannian stromal (SS) cells: these tumors are grouped as Neuroblastoma (Schwannian stroma-poor). The remaining NTs are composed of abundant SS cells and classified as Ganglioneuroblastoma (Schwannian stroma-rich) intermixed or nodular and Ganglioneuroma. The importance to understand Nb and SS gene signatures in NTs, is to clarify the complex network mechanism of tumor growth and progression. In order to identify the Nb and SS cells gene signatures, we analyzed the gene expression profiling of 19 cases of neuroblastic tumors: 10 stroma poor (NTs-SP) and 9 stroma rich (NTs-SR), by high density oligonucleotide microarrays. Moreover, the analysis was performed in parallel on both whole and laser microdissected tumor samples: from 4 of 19 cases, was isolated different areas all composed of pure cellular populations. We performed genome wide expression analysis by using Affymetrix technology and we used two different approaches for data analysis: SAM (Significance Analysis of Microarrays) and a method based on Game Theory (GT), to identify genes differently expressed in SS and Nb cells. Differently from the SAM method, the analysis based on GT (Moretti et al. (2006)) gives the advantage of selecting relevant genes not only according to the expression profile of each single gene, but considering also gene interaction. Experiment Overall Design: Tissue samples from 10 primary neuroblastoma stroma-poor (NTs-SP) and 9 ganglioneuroblastoma/ganglioneuroma stroma-rich (NTs-SR) tumors, were obtained at diagnosis from patients at different clinical stage. Frozen samples of NTs-SP had a minimum content of 90% of malignant cells, while NTs-SR had more than 80-90% of schwannian stromal cells. Four out of 19 NTs: 2 neuroblastomas (Schwannian stoma-poor) and 2 ganglioneublastomas (Schwannian stroma-rich), were further analyzed with laser microdissection.',
      accession_code: 'E-GEOD-7529',
      platform_accession_code: 'A-AFFY-33',
      source_database: 'ARRAY_EXPRESS',
      source_url:
        'https://www.ebi.ac.uk/arrayexpress/json/v3/experiments/E-GEOD-7529',
      platform_name: 'Affymetrix GeneChip Human Genome HG-U133A [HG-U133A]',
      has_publication: false,
      publication_title: '',
      publication_doi: '',
      pubmed_id: '',
      samples: [
        {
          id: 1,
          accession_code: 'GSM414087 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.889263Z',
          last_modified: '2018-04-19T18:46:50.889263Z'
        },
        {
          id: 2,
          accession_code: 'GSM414086 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.921606Z',
          last_modified: '2018-04-19T18:46:50.921606Z'
        },
        {
          id: 3,
          accession_code: 'GSM414085 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.934763Z',
          last_modified: '2018-04-19T18:46:50.934763Z'
        },
        {
          id: 4,
          accession_code: 'GSM414084 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.949774Z',
          last_modified: '2018-04-19T18:46:50.949774Z'
        },
        {
          id: 5,
          accession_code: 'GSM414083 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.965318Z',
          last_modified: '2018-04-19T18:46:50.965318Z'
        },
        {
          id: 6,
          accession_code: 'GSM414082 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.980007Z',
          last_modified: '2018-04-19T18:46:50.980007Z'
        },
        {
          id: 7,
          accession_code: 'GSM414081 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.996349Z',
          last_modified: '2018-04-19T18:46:50.996349Z'
        },
        {
          id: 8,
          accession_code: 'GSM414080 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.008842Z',
          last_modified: '2018-04-19T18:46:51.008842Z'
        },
        {
          id: 9,
          accession_code: 'GSM414079 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.019163Z',
          last_modified: '2018-04-19T18:46:51.019163Z'
        },
        {
          id: 10,
          accession_code: 'GSM414078 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.030051Z',
          last_modified: '2018-04-19T18:46:51.030051Z'
        },
        {
          id: 11,
          accession_code: 'GSM414077 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.039925Z',
          last_modified: '2018-04-19T18:46:51.039925Z'
        },
        {
          id: 12,
          accession_code: 'GSM414076 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.050403Z',
          last_modified: '2018-04-19T18:46:51.050403Z'
        },
        {
          id: 13,
          accession_code: 'GSM414075 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.059208Z',
          last_modified: '2018-04-19T18:46:51.059208Z'
        },
        {
          id: 14,
          accession_code: 'GSM414074 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:51.068174Z',
          last_modified: '2018-04-19T18:46:51.068174Z'
        }
      ],
      submitter_institution: 'National Institute for Cancer Research (IST)',
      created_at: '2018-04-19T18:46:56.213486Z',
      last_modified: '2018-04-19T18:46:56.733813Z'
    },
    {
      id: 3,
      title: 'Transcription profiling of human neuroblastic tumors',
      description:
        'The expression profiles of 64 neuroblastic tumors (mainly neuroblastoma) were determined on Affymetrix chips HG U133 Plus 2.0. Experiment Overall Design: 64 neuroblastic tumors',
      accession_code: 'E-GEOD-12460',
      platform_accession_code: 'A-AFFY-44',
      source_database: 'ARRAY_EXPRESS',
      source_url:
        'https://www.ebi.ac.uk/arrayexpress/json/v3/experiments/E-GEOD-12460',
      platform_name:
        'Affymetrix GeneChip Human Genome U133 Plus 2.0 [HG-U133_Plus_2]',
      has_publication: true,
      publication_title:
        'Somatic and germline activating mutations of the ALK kinase receptor in neuroblastoma.',
      publication_doi: '18923523',
      pubmed_id: '18923523',
      samples: [
        {
          id: 1,
          accession_code: 'GSM414087 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.889263Z',
          last_modified: '2018-04-19T18:46:50.889263Z'
        },
        {
          id: 2,
          accession_code: 'GSM414086 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.921606Z',
          last_modified: '2018-04-19T18:46:50.921606Z'
        },
        {
          id: 3,
          accession_code: 'GSM414085 1',
          organism: {
            name: 'HOMO_SAPIENS',
            taxonomy_id: 9606
          },
          is_downloaded: false,
          is_processed: false,
          created_at: '2018-04-19T18:46:50.934763Z',
          last_modified: '2018-04-19T18:46:50.934763Z'
        }
      ],
      submitter_institution: 'Institut Curie',
      created_at: '2018-04-19T18:47:02.212132Z',
      last_modified: '2018-04-19T18:47:02.799251Z'
    }
  ]
};

export default (state = initialState, action) => {
  switch (action.type) {
    case 'DOWNLOAD_EXPERIMENT_REMOVED': {
      const { experimentId } = action.data;
      const filteredExperiments = state.experiments.filter(
        experiment => experiment.id !== experimentId
      );
      return {
        ...state,
        experiments: filteredExperiments
      };
    }
    case 'DOWNLOAD_SPECIES_REMOVED': {
      const { speciesName } = action.data;
      const experimentsWithFilteredSamples = state.experiments.reduce(
        (filteredExperiments, experiment) => {
          const filteredSamples = experiment.samples.filter(
            sample => sample.organism.name !== speciesName
          );
          if (filteredSamples.length) filteredExperiments.push(filteredSamples);
          return filteredExperiments;
        },
        []
      );

      return {
        ...state,
        experiments: experimentsWithFilteredSamples
      };
    }
    default:
      return state;
  }
};

export function groupSamplesBySpecies(state) {
  const { experiments = [] } = state.download;

  return experiments.reduce((species, experiment) => {
    if (!experiment.samples) return species;
    experiment.samples.forEach(sample => {
      const { organism: { name: organismName } } = sample;
      species[organismName] = species[organismName] || [];
      species[organismName].push(sample);
    });
    return species;
  }, {});
}
